#
# This command updates the sample configuration document for active-metadata-server.  It uses IntelliJ's HTTP Client.
#
@baseURL=https://localhost:9443
@adminUserId=garygeeke

###
# =====================================================================================================================
# Manage the authentication token.  Run this request to create/refresh the token.

# @name Token (RequestBody)
POST {{baseURL}}/api/token
Content-Type: application/json

{
  "userId" : "{{adminUserId}}",
  "password" : "secret"
}

> {% client.global.set("token", response.body); %}

###
# ---------------------------------------------
# Metadata Access Store: active-metadata-store
#

###
# @name Enable the PostgreSQL Repository
# Set up the local repository to use the PostgreSQL Repository implementation.
POST {{baseURL}}/open-metadata/admin-services/servers/active-metadata-store/local-repository/mode/postgres-repository
Authorization: Bearer {{token}}
Content-Type: application/json

{
    "databaseURL": "~{repositoryDatabaseURL}~?currentSchema=repository_active_metadata_store",
    "databaseSchema": "repository_active_metadata_store",
    "secretsStore": "~{egeriaServersSecretsStore}~",
    "secretsCollectionName": "~{repositorySecretCollectionName}~"
}

###